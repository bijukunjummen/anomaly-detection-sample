package anom.dbscan;

import org.apache.commons.math3.ml.clustering.Cluster;
import org.apache.commons.math3.ml.clustering.DBSCANClusterer;
import org.apache.commons.math3.ml.clustering.DoublePoint;
import org.junit.Test;

import java.util.Arrays;
import java.util.Collection;
import java.util.List;

public class DbscanClustererTest {

    @Test
    public void testDbScanClusterer() {
        DBSCANClusterer dbscanClusterer = new DBSCANClusterer(15, 5);

        List<Cluster> clusters = dbscanClusterer.cluster(sampleLatencyValues());

        
        // Question to answer - is a value in any of the clusters - if not then it is likely an outlier.
        for (Cluster cluster : clusters) {
            System.out.println(cluster.getPoints());
        }
    }


    private Collection<DoublePoint> sampleLatencyValues() {
        final DoublePoint[] points = new DoublePoint[]{
                new DoublePoint(new double[]{1532092208, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092213, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092218, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092223, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092228, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092233, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092238, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092243, 0.0040003 * 1000}),
                new DoublePoint(new double[]{1532092248, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092253, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092258, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092263, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092268, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092273, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092278, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092283, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092288, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092293, 0.0040922 * 1000}),
                new DoublePoint(new double[]{1532092298, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092303, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092308, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092313, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092318, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092323, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092328, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092333, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092338, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092343, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092348, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092353, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092358, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092363, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092368, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092373, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092378, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092383, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092388, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092393, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092398, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092403, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092408, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092413, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092418, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092423, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092428, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092433, 0.0043023 * 1000}),
                new DoublePoint(new double[]{1532092438, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092443, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092448, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092453, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092458, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092463, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092468, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092473, 0.0035516 * 1000}),
                new DoublePoint(new double[]{1532092478, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092483, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092488, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092493, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092498, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092503, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092508, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092513, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092518, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092523, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092528, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092533, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092538, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092543, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092548, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092553, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092558, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092563, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092568, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092573, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092578, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092583, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092588, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092593, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092598, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092603, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092608, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092613, 0.0063965 * 1000}),
                new DoublePoint(new double[]{1532092618, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092623, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092628, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092633, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092638, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092643, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092648, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092653, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092658, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092663, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092668, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092673, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092678, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092683, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092688, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092693, 0.004022 * 1000}),
                new DoublePoint(new double[]{1532092698, 0.0076428 * 1000}),
                new DoublePoint(new double[]{1532092703, 0.0076428 * 1000}),
                new DoublePoint(new double[]{1532092708, 0.0076428 * 1000}),
                new DoublePoint(new double[]{1532092713, 0.0076428 * 1000}),
                new DoublePoint(new double[]{1532092718, 0.0076428 * 1000}),
                new DoublePoint(new double[]{1532092723, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092728, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092733, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092738, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092743, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092748, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092753, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092758, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092763, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092768, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092773, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092778, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092783, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092788, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092793, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092798, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092803, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092808, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092813, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092818, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092823, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092828, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092833, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092838, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092843, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092848, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092853, 0.0230083 * 1000}),
                new DoublePoint(new double[]{1532092858, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092863, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092868, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092873, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092878, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092883, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092888, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092893, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092898, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092903, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092908, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092913, 0.00425 * 1000}),
                new DoublePoint(new double[]{1532092918, 0.0040454 * 1000}),
                new DoublePoint(new double[]{1532092923, 0.0040454 * 1000}),
                new DoublePoint(new double[]{1532092928, 0.0040454 * 1000}),
                new DoublePoint(new double[]{1532092933, 0.0040454 * 1000}),
                new DoublePoint(new double[]{1532092938, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092943, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092948, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092953, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092958, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092963, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092968, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092973, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092978, 0.0043514 * 1000}),
                new DoublePoint(new double[]{1532092983, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532092988, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532092993, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532092998, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093003, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093008, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093013, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093018, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093023, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093028, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093033, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093038, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093043, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093048, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093053, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093058, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093063, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093068, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093073, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093078, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093083, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093088, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093093, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093098, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093103, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093108, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093113, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093118, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093123, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093128, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093133, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093138, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093143, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093148, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093153, 0.005647 * 1000}),
                new DoublePoint(new double[]{1532093158, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093163, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093168, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093173, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093178, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093183, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093188, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093193, 0.0041597 * 1000}),
                new DoublePoint(new double[]{1532093198, 0.0052919 * 1000}),
                new DoublePoint(new double[]{1532093203, 0.0052919 * 1000}),
                new DoublePoint(new double[]{1532093208, 0.0053309 * 1000}),
                new DoublePoint(new double[]{1532093213, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093218, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093223, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093228, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093233, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093238, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093243, 0.0063168 * 1000}),
                new DoublePoint(new double[]{1532093248, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093253, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093258, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093263, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093268, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093273, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093278, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093283, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093288, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093293, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093298, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093303, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093308, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093313, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093318, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093323, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093328, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093333, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093338, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093343, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093348, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093353, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093358, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093363, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093368, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093373, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093378, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093383, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093388, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093393, 0.0078976 * 1000}),
                new DoublePoint(new double[]{1532093398, 0.0042216 * 1000}),
                new DoublePoint(new double[]{1532093403, 0.004221 * 1000})
        };

        List<DoublePoint> list = Arrays.asList(points);
        return list;
    }
}
